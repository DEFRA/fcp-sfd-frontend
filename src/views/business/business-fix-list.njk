{% extends 'common/layout.njk' %}

{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "common/navigation/back-sign-out-link.njk" import appBackSignOutLink with context %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/date-input/macro.njk" import govukDateInput %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/fieldset/macro.njk" import govukFieldset %}

{% block beforeContent %}
  {{ appBackSignOutLink(backLink) }}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

    {% if errors %}
      {{ govukErrorSummary({
          titleText: "There is a problem",
          errorList: errors | toErrorList
      }) }}
    {% endif %}

      <form method="post" novalidate>
        <input type="hidden" name="crumb" value="{{ crumb }}">
        <fieldset class="govuk-fieldset">
          <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
            <h1 class="govuk-fieldset__heading">
              {{ pageTitle }}
            </h1>
          </legend>
            <div><p>
            We will use these details to contact you, or to verify your identity if you phone us.
            </p></div>

        <div class="govuk-!-margin-top-4">
          {% for section in sections %}
            {% if section === 'name' %}
              <h2 class="govuk-heading-m">Business name</h2>
              {{ govukInput({
                id: "business-name",
                name: "businessName",
                value: businessName,
                errorMessage: errors.businessName and {
                  text: errors.businessName.text
                }
              }) }}
            {% endif %}

            {% if section === 'address' %}
              <h2 class="govuk-heading-m">What is your address?</h2>
              {{ govukInput({
                label: {
                  text: "Address line 1"
                },
                hint: {
                  text: "Include flat and floor numbers, where appropriate"
                },
                id: "address1",
                name: "address1",
                value: address.address1,
                autocomplete: "address-1",
                errorMessage: errors.address1 and {
                  text: errors.address1.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Address line 2 (optional)"
                },
                id: "address2",
                name: "address2",
                value: address.address2,
                autocomplete: "address-2",
                errorMessage: errors.address2 and {
                  text: errors.address2.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Address line 3 (optional)"
                },
                id: "address3",
                name: "address3",
                value: address.address3,
                autocomplete: "address-3",
                errorMessage: errors.address3 and {
                  text: errors.address3.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Town or city"
                },
                classes: "govuk-!-width-two-thirds",
                id: "city",
                name: "city",
                value: address.city,
                autocomplete: "address-level2",
                errorMessage: errors.city and {
                  text: errors.city.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "County (optional)"
                },
                classes: "govuk-!-width-two-thirds",
                id: "county",
                name: "county",
                value: address.county,
                errorMessage: errors.county and {
                  text: errors.county.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Postal code or zip code"
                },
                classes: "govuk-input--width-10",
                id: "postcode",
                name: "postcode",
                value: address.postcode,
                autocomplete: "postal-code",
                errorMessage: errors.postcode and {
                  text: errors.postcode.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Country"
                },
                classes: "govuk-!-width-two-thirds",
                id: "country",
                name: "country",
                value: address.country,
                autocomplete: "country-name",
                errorMessage: errors.country and {
                  text: errors.country.text
                }
              }) }}
            {% endif %}

            {% if section === 'phone' %}
              <h2 class="govuk-heading-m">Business phone numbers</h2>
              <div class="govuk-hint">
                Enter at least one phone number
              </div>

              {{ govukInput({
                label: {
                  text: "Business telephone number"
                },
                classes: "govuk-input--width-20",
                type: "tel",
                id: "businessTelephone",
                name: "businessTelephone",
                value: businessTelephone,
                autocomplete: "telephone",
                errorMessage: errors.businessTelephone and {
                  text: errors.businessTelephone.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Business mobile phone number"
                },
                classes: "govuk-input--width-20",
                type: "tel",
                id: "businessMobile",
                name: "businessMobile",
                value: businessMobile,
                autocomplete: "mobile",
                errorMessage: errors.businessMobile and {
                  text: errors.businessMobile.text
                }
              }) }}
            {% endif %}

            {% if section === 'email' %}
              <h2 class="govuk-heading-m">Business email address</h2>
              {{ govukInput({
                classes: "govuk-input--width-20",
                id: "businessEmail",
                name: "businessEmail",
                value: businessEmail,
                errorMessage: errors.businessEmail and {
                  text: errors.businessEmail.text
                }
              }) }}
            {% endif %}

            {% if section === 'vat' %}
              <h2 class="govuk-heading-m">Business VAT number</h2>
              {{ govukInput({
                hint: {
                  html: "
                    <div>If you are adding or updating your VAT number, enter the 9 digit number on your VAT registration certificate. You only need to enter the numbers. For example, if your VAT registration number is GB123456789, you should enter 123456789.</div>
                    <div>If you are removing your VAT number, delete the number and leave the field blank.</div>
                  "
                },
                classes: "govuk-input--width-20",
                id: "business-vat",
                name: "vatNumber",
                value: vatNumber,
                errorMessage: errors.vatNumber and {
                  text: errors.vatNumber.text
                }
              }) }}
            {% endif %}
          {% endfor %}
        </div>
      </fieldset>

      {{ govukButton({ text: "Continue", preventDoubleClick: true }) }}
    </form>
  </div>
</div>
{% endblock %}

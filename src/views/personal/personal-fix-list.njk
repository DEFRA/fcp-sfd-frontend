{% extends 'common/layout.njk' %}

{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "common/navigation/back-sign-out-link.njk" import appBackSignOutLink with context %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/date-input/macro.njk" import govukDateInput %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/fieldset/macro.njk" import govukFieldset %}

{% block beforeContent %}
  {{ appBackSignOutLink(backLink) }}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

    {% if errors %}
      {{ govukErrorSummary({
          titleText: "There is a problem",
          errorList: errors | toErrorList
      }) }}
    {% endif %}

      <form method="post" novalidate>
        <input type="hidden" name="crumb" value="{{ crumb }}">
        <fieldset class="govuk-fieldset">
          <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
            <h1 class="govuk-fieldset__heading">
              {{ pageTitle }}
            </h1>
          </legend>
            <div><p>
            We will use these details to contact you, or to verify your identity if you phone us.
            </p></div>

        <div class="govuk-!-margin-top-4">
          {% for section in sections %}
            {% if section === 'name' %}
              <h2 class="govuk-heading-m">Personal name</h2>
              {{ govukInput({
                label: {
                  text: "First name"
                },
                id: "first",
                name: "first",
                value: name.first,
                errorMessage: errors.first and {
                  text: errors.first.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Middle names"
                },
                id: "middle",
                name: "middle",
                value: name.middle,
                errorMessage: errors.middle and {
                  text: errors.middle.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Last name"
                },
                id: "last",
                name: "last",
                value: name.last,
                errorMessage: errors.last and {
                  text: errors.last.text
                }
              }) }}
            {% endif %}

            {% if section === 'address' %}
              <h2 class="govuk-heading-m">Personal address</h2>
              {{ govukInput({
                label: {
                  text: "Address line 1"
                },
                hint: {
                  text: "Include flat and floor numbers, where appropriate"
                },
                id: "address1",
                name: "address1",
                value: address.address1,
                autocomplete: "address-1",
                errorMessage: errors.address1 and {
                  text: errors.address1.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Address line 2 (optional)"
                },
                id: "address2",
                name: "address2",
                value: address.address2,
                autocomplete: "address-2",
                errorMessage: errors.address2 and {
                  text: errors.address2.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Address line 3 (optional)"
                },
                id: "address3",
                name: "address3",
                value: address.address3,
                autocomplete: "address-3",
                errorMessage: errors.address3 and {
                  text: errors.address3.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Town or city"
                },
                classes: "govuk-!-width-two-thirds",
                id: "city",
                name: "city",
                value: address.city,
                autocomplete: "address-level2",
                errorMessage: errors.city and {
                  text: errors.city.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "County (optional)"
                },
                classes: "govuk-!-width-two-thirds",
                id: "county",
                name: "county",
                value: address.county,
                errorMessage: errors.county and {
                  text: errors.county.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Postal code or zip code"
                },
                classes: "govuk-input--width-10",
                id: "postcode",
                name: "postcode",
                value: address.postcode,
                autocomplete: "postal-code",
                errorMessage: errors.postcode and {
                  text: errors.postcode.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Country"
                },
                classes: "govuk-!-width-two-thirds",
                id: "country",
                name: "country",
                value: address.country,
                autocomplete: "country-name",
                errorMessage: errors.country and {
                  text: errors.country.text
                }
              }) }}
            {% endif %}

            {% if section === 'phone' %}
              <h2 class="govuk-heading-m">Personal phone numbers</h2>
              <div class="govuk-hint">
                Enter at least one phone number
              </div>

              {{ govukInput({
                label: {
                  text: "Personal telephone number"
                },
                classes: "govuk-input--width-20",
                type: "tel",
                id: "personalTelephone",
                name: "personalTelephone",
                value: personalTelephone,
                autocomplete: "telephone",
                errorMessage: errors.personalTelephone and {
                  text: errors.personalTelephone.text
                }
              }) }}

              {{ govukInput({
                label: {
                  text: "Personal mobile phone number"
                },
                classes: "govuk-input--width-20",
                type: "tel",
                id: "personalMobile",
                name: "personalMobile",
                value: personalMobile,
                autocomplete: "mobile",
                errorMessage: errors.personalMobile and {
                  text: errors.personalMobile.text
                }
              }) }}
            {% endif %}

            {% if section === 'email' %}
              <h2 class="govuk-heading-m">Personal email address</h2>
              {{ govukInput({
                label: {
                  text: "Personal email address"
                },
                classes: "govuk-input--width-20",
                id: "personalEmail",
                name: "personalEmail",
                value: personalEmail,
                errorMessage: errors.personalEmail and {
                  text: errors.personalEmail.text
                }
              }) }}
            {% endif %}

            {% if section === 'dob' %}
              <h2 class="govuk-heading-m">Personal date of birth</h2>
              {{ govukDateInput({
                label: {
                  text: "Date of birth"
                },
                id: "dob",
                errorMessage: dateError and {
                  text: dateError.text
                },
                hint: {
                  text: 'For example, 31 3 1980'
                },
                items: [
                  {
                    classes: "govuk-input--width-2 " + dayErrorClass,
                    name: "day",
                    value: dateOfBirth.day,
                    id: 'day'
                  },
                  {
                    classes: "govuk-input--width-2 " + monthErrorClass,
                    name: "month",
                    value: dateOfBirth.month,
                    id: 'month'
                  },
                  {
                    classes: "govuk-input--width-4 " + yearErrorClass,
                    name: "year",
                    value: dateOfBirth.year,
                    id: 'year'
                  }
                ]
              }) }}
            {% endif %}
          {% endfor %}
        </div>
      </fieldset>

      {{ govukButton({ text: "Continue", preventDoubleClick: true }) }}
    </form>
  </div>
</div>
{% endblock %}
